import { StepDefinition } from '../types/lesson.js';

export const lessonSteps: StepDefinition[] = [
  {
    id: 'lesson_intro',
    order: 1,
    conceptId: 'fractions-as-magnitudes',
    representation: 'symbolic',
    stepType: 'info',
    prompt: 'Fractions tell us how many equal parts of a whole we are looking at. Think of them as distances from zero.',
    answerType: 'none',
    correctAnswer: null,
    metadata: { difficulty: 'intro', tags: ['intro'] },
  },
  {
    id: 'numberline_one_half',
    order: 2,
    conceptId: 'fractions-as-magnitudes',
    representation: 'number_line',
    stepType: 'question',
    prompt: 'Place 1/2 on the number line between 0 and 1.',
    answerType: 'placement',
    correctAnswer: { value: 0.5 },
    metadata: { difficulty: 'intro', tags: ['halves'] },
  },
  {
    id: 'bar_three_fourths',
    order: 3,
    conceptId: 'fractions-as-magnitudes',
    representation: 'bar',
    stepType: 'question',
    prompt: 'Shade 3/4 of the bar below.',
    answerType: 'shading',
    correctAnswer: { shaded: 0.75 },
    metadata: { difficulty: 'core', tags: ['fourths'] },
  },
  {
    id: 'circle_two_fifths',
    order: 4,
    conceptId: 'fractions-as-magnitudes',
    representation: 'circle',
    stepType: 'question',
    prompt: 'Shade two-fifths of the circle.',
    answerType: 'shading',
    correctAnswer: { shaded: 0.4 },
    metadata: { difficulty: 'core', tags: ['fifths'] },
  },
  {
    id: 'compare_one_third_vs_quarter',
    order: 5,
    conceptId: 'fractions-as-magnitudes',
    representation: 'symbolic',
    stepType: 'question',
    prompt: 'Which is greater: 1/3 or 1/4?',
    answerType: 'choice',
    correctAnswer: { option: '1/3' },
    metadata: { difficulty: 'core', tags: ['comparison'] },
  },
  {
    id: 'numberline_three_fourths',
    order: 6,
    conceptId: 'fractions-as-magnitudes',
    representation: 'number_line',
    stepType: 'question',
    prompt: 'Place 3/4 on the number line between 0 and 1.',
    answerType: 'placement',
    correctAnswer: { value: 0.75 },
    metadata: { difficulty: 'core', tags: ['fourths'] },
  },
  {
    id: 'bar_compare_two_thirds_vs_three_fifths',
    order: 7,
    conceptId: 'fractions-as-magnitudes',
    representation: 'bar',
    stepType: 'question',
    prompt: 'Use the bars to decide whether 2/3 or 3/5 is larger.',
    answerType: 'choice',
    correctAnswer: { option: '2/3' },
    metadata: { difficulty: 'challenge', tags: ['comparison'] },
  },
  {
    id: 'checkpoint_q1',
    order: 8,
    conceptId: 'fractions-as-magnitudes',
    representation: 'number_line',
    stepType: 'checkpoint',
    prompt: 'Checkpoint: Place 1/4 on the line.',
    answerType: 'placement',
    correctAnswer: { value: 0.25 },
    metadata: { difficulty: 'challenge', tags: ['checkpoint'] },
  },
  {
    id: 'checkpoint_q2',
    order: 9,
    conceptId: 'fractions-as-magnitudes',
    representation: 'bar',
    stepType: 'checkpoint',
    prompt: 'Checkpoint: Shade 5/6 of the bar.',
    answerType: 'shading',
    correctAnswer: { shaded: 0.8333 },
    metadata: { difficulty: 'challenge', tags: ['checkpoint'] },
  },
  {
    id: 'checkpoint_q3',
    order: 10,
    conceptId: 'fractions-as-magnitudes',
    representation: 'symbolic',
    stepType: 'checkpoint',
    prompt: 'Checkpoint: Which is greater: 3/8 or 1/2?',
    answerType: 'choice',
    correctAnswer: { option: '1/2' },
    metadata: { difficulty: 'challenge', tags: ['checkpoint'] },
  },
  {
    id: 'summary',
    order: 11,
    conceptId: 'fractions-as-magnitudes',
    representation: 'symbolic',
    stepType: 'info',
    prompt: 'Summary coming up.',
    answerType: 'none',
    correctAnswer: null,
  },
  // Alternate remedial representations
  {
    id: 'bar_one_half_alt',
    order: 100,
    conceptId: 'fractions-as-magnitudes',
    representation: 'bar',
    stepType: 'question',
    prompt: 'Shade exactly one-half of the bar.',
    answerType: 'shading',
    correctAnswer: { shaded: 0.5 },
    metadata: { alternateFor: 'numberline_one_half', difficulty: 'intro' },
  },
  {
    id: 'circle_three_fourths_alt',
    order: 101,
    conceptId: 'fractions-as-magnitudes',
    representation: 'circle',
    stepType: 'question',
    prompt: 'Shade three-fourths of the circle to match the portion.',
    answerType: 'shading',
    correctAnswer: { shaded: 0.75 },
    metadata: { alternateFor: 'numberline_three_fourths', difficulty: 'core' },
  },
];

export const orderedLessonSteps = lessonSteps
  .filter((step) => !step.metadata?.alternateFor)
  .sort((a, b) => a.order - b.order);
